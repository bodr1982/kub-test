В папке собрано все необходимое для разворачивания прилоожения.

Создан docker-compose, чтоб можно было локально запустить и оттестировать контейнеры. Сама связка состоит из контейнера MySql, в котором во время старта запускается sql скрипт (мы разварачиваем таблицу), adminer - gui для нашего MySql. Наше приложение состоит так же из контейнера, который собирается в ручную, и в котором установлены nodejs и скритпты для запуска и подключения к MySql через комманду `npm prod`

Для того, чтобы собрать контейнер в ручную, необходимо в корне проекта запустить комманды:

`docker build -f /docker/npm/Dockerfile -t bodr1982/npmtest .`

Эта комманда соберет контейнер bodr1982/npmtest, чтобы сделать push контейнера в hub.docker.com, необходимо залогиниться через

`docker login`

Push в hub.docker.command

`docker push bodr1982/npmtest`

Итак. В проекте 3 основные папки:

1) docker - сдесь хранится все необходимое для сборки контейнеров
2) kubernetes - тут папка для хранения скриптов по работе с k8s
3) src - приложение, запускаемое на nodejs, основной функционал подключение к MySql

Чтобы обеспечить развертывание необходимого количества экземпляров мы будем использовать сервысы (хотя и создан фаил для разворачивания как Deployments). Для разворачивания используем StatefulSet, в котором мы указываем необходимое количество реплик (возможно количество вынести в переменные, чтоб не ограничивать в скриптах). Это даст возможность нам балансировать нагрузку между pods и контролировать их состояния. Для разворачивания необходимо использовать команду:

`kubectl apply -f web-service.yaml`

Кубернетис позволяет вести журнирование логов, но они становятся не доступны и будут удалены при неудачном развертывании или ошибке при старте. Вместо того, чтобы вести журналирование на уровне узла или модуля, я выбрал вариант отправки журналов в серверную часть. Возможно реализовать через Persistent Volumes, тома как и в docker дают возможность хранить конфигурации на физических дисках, данный функционал будет реализован в следующих релизах. Так же можно расшарить папку со сбором логов через nfs.

Для мониторинга состояния прилоэжения возможно использовать несколько методов.
Один из вариантов - использование Prometheus

https://prometheus.io/

Prometheus одна из самых распространенных утелит. Есть возможность мониторить через dashboard:

https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/

так же можно использовать другие утелиты (https://zen.yandex.ru/media/itgrad/10-utilit-dlia-monitoringa-kubernetes-5e33e3e153de5721ccf76ac5)


Для развертывания контейнеров в кубернетис предпологается использовать helm

Для контейнера в Pod'е зарезервировано 128 Мб памяти и выставлено 256 Мб ограничения
